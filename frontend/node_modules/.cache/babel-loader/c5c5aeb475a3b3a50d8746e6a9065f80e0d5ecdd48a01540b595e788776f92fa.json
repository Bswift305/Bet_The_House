{"ast":null,"code":"// OddsWidget.tsx\nimport React,{useEffect,useState}from'react';import{useQuery}from'react-query';import axios from'axios';import io from'socket.io-client';import{LineChart,Line,XAxis,YAxis,Tooltip,ResponsiveContainer,CartesianGrid}from'recharts';// --- Types ---\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";// --- Data Fetcher ---\nconst fetchLiveOdds=async()=>{const{data}=await axios.get('http://localhost:3001/api/odds/live');return data;};// --- WebSocket Setup ---\nconst socket=io('http://localhost:3001');// --- Component ---\nconst OddsWidget=()=>{const{data:events,isLoading,error}=useQuery('liveOdds',fetchLiveOdds,{refetchInterval:10000});const[oddsMovement,setOddsMovement]=useState([]);useEffect(()=>{socket.on('oddsUpdate',data=>{const timestamp=new Date().toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});setOddsMovement(prev=>[...prev.slice(-5),{time:timestamp,odds:data.odds}]);// Keep only last 6 points\n});return()=>{socket.off('oddsUpdate');};},[]);if(isLoading)return/*#__PURE__*/_jsx(\"div\",{className:\"p-4\",children:\"Loading odds...\"});if(error)return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 text-red-600\",children:\"Error loading odds.\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-4\",children:\"Live Betting Odds\"}),events===null||events===void 0?void 0:events.map(event=>/*#__PURE__*/_jsxs(\"div\",{className:\"border rounded-xl p-4 bg-white shadow-md space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-500\",children:[event.sport,\" \\u2013 \",event.league]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-400\",children:new Date(event.timestamp).toLocaleTimeString()})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-1\",children:event.teams.map(team=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{children:team.name}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:team.odds})]},team.teamId))}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:event.markets.map(market=>/*#__PURE__*/_jsxs(\"div\",{className:\"border-t pt-2\",children:[market.marketType==='total'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-semibold\",children:[\"Total line: \",market.line]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Over\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:market.odds.home})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Under\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:market.odds.away})]})]}),market.marketType==='spread'&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"font-semibold\",children:[\"Spread start: \",market.line>0?`+${market.line}`:market.line]}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-medium\",children:[\"Home \",market.odds.home,\" / Away \",market.odds.away]})]})]},market.marketId))}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-semibold mb-1\",children:\"Odds Movement (Live)\"}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:200,children:/*#__PURE__*/_jsxs(LineChart,{data:oddsMovement,children:[/*#__PURE__*/_jsx(CartesianGrid,{strokeDasharray:\"3 3\"}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"time\"}),/*#__PURE__*/_jsx(YAxis,{}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Line,{type:\"monotone\",dataKey:\"odds\",stroke:\"#2563eb\",strokeWidth:2,dot:{r:3}})]})})]})})]},event.eventId))]});};export default OddsWidget;","map":{"version":3,"names":["React","useEffect","useState","useQuery","axios","io","LineChart","Line","XAxis","YAxis","Tooltip","ResponsiveContainer","CartesianGrid","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","fetchLiveOdds","data","get","socket","OddsWidget","events","isLoading","error","refetchInterval","oddsMovement","setOddsMovement","on","timestamp","Date","toLocaleTimeString","hour","minute","prev","slice","time","odds","off","className","children","map","event","sport","league","teams","team","name","teamId","markets","market","marketType","line","home","away","marketId","width","height","strokeDasharray","dataKey","type","stroke","strokeWidth","dot","r","eventId"],"sources":["C:/Users/Decatur/betting-dashboard/frontend/src/components/OddsWidget.tsx"],"sourcesContent":["// OddsWidget.tsx\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useQuery } from 'react-query';\r\nimport axios from 'axios';\r\nimport io from 'socket.io-client';\r\nimport {\r\n  LineChart,\r\n  Line,\r\n  XAxis,\r\n  YAxis,\r\n  Tooltip,\r\n  ResponsiveContainer,\r\n  CartesianGrid,\r\n} from 'recharts';\r\n\r\n// --- Types ---\r\nexport type LineType = 'moneyline' | 'spread' | 'total';\r\n\r\nexport interface TeamOdds {\r\n  teamId: string;\r\n  name: string;\r\n  odds: number;\r\n  lineType: LineType;\r\n  updated: string; // ISO timestamp\r\n}\r\n\r\nexport type MarketType = 'spread' | 'total' | 'moneyline';\r\n\r\nexport interface MarketOdds {\r\n  marketId: string;\r\n  marketType: MarketType;\r\n  odds: {\r\n    home: number;\r\n    away: number;\r\n  };\r\n  line: number;\r\n}\r\n\r\nexport interface LiveOdds {\r\n  eventId: string;\r\n  sport: string;\r\n  league: string;\r\n  teams: TeamOdds[];\r\n  markets: MarketOdds[];\r\n  timestamp: string;\r\n}\r\n\r\n// --- Data Fetcher ---\r\nconst fetchLiveOdds = async (): Promise<LiveOdds[]> => {\r\n  const { data } = await axios.get<LiveOdds[]>('http://localhost:3001/api/odds/live');\r\n  return data;\r\n};\r\n\r\n// --- WebSocket Setup ---\r\nconst socket = io('http://localhost:3001');\r\n\r\n// --- Component ---\r\nconst OddsWidget: React.FC = () => {\r\n  const { data: events, isLoading, error } = useQuery<LiveOdds[]>('liveOdds', fetchLiveOdds, {\r\n    refetchInterval: 10000,\r\n  });\r\n\r\n  const [oddsMovement, setOddsMovement] = useState<{ time: string; odds: number }[]>([]);\r\n\r\nuseEffect(() => {\r\n  socket.on('oddsUpdate', (data) => {\r\n    const timestamp = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\r\n    setOddsMovement((prev) => [...prev.slice(-5), { time: timestamp, odds: data.odds }]); // Keep only last 6 points\r\n  });\r\n\r\n  return () => {\r\n    socket.off('oddsUpdate');\r\n  };\r\n}, []);\r\n\r\n  if (isLoading) return <div className=\"p-4\">Loading odds...</div>;\r\n  if (error) return <div className=\"p-4 text-red-600\">Error loading odds.</div>;\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      <h2 className=\"text-xl font-bold mb-4\">Live Betting Odds</h2>\r\n\r\n      {events?.map((event) => (\r\n        <div\r\n          key={event.eventId}\r\n          className=\"border rounded-xl p-4 bg-white shadow-md space-y-4\"\r\n        >\r\n          {/* Header */}\r\n          <div className=\"flex justify-between items-center\">\r\n            <div className=\"text-sm text-gray-500\">\r\n              {event.sport} â€“ {event.league}\r\n            </div>\r\n            <div className=\"text-xs text-gray-400\">\r\n              {new Date(event.timestamp).toLocaleTimeString()}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Team Odds */}\r\n          <div className=\"space-y-1\">\r\n            {event.teams.map((team) => (\r\n              <div key={team.teamId} className=\"flex justify-between\">\r\n                <span>{team.name}</span>\r\n                <span className=\"font-medium\">{team.odds}</span>\r\n              </div>\r\n            ))}\r\n          </div>\r\n\r\n          {/* Market Details */}\r\n          <div className=\"space-y-3\">\r\n            {event.markets.map((market) => (\r\n              <div key={market.marketId} className=\"border-t pt-2\">\r\n                {market.marketType === 'total' && (\r\n                  <>\r\n                    <div className=\"font-semibold\">Total line: {market.line}</div>\r\n                    <div className=\"flex justify-between\">\r\n                      <span>Over</span>\r\n                      <span className=\"font-medium\">{market.odds.home}</span>\r\n                    </div>\r\n                    <div className=\"flex justify-between\">\r\n                      <span>Under</span>\r\n                      <span className=\"font-medium\">{market.odds.away}</span>\r\n                    </div>\r\n                  </>\r\n                )}\r\n\r\n                {market.marketType === 'spread' && (\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"font-semibold\">\r\n                      Spread start: {market.line > 0 ? `+${market.line}` : market.line}\r\n                    </span>\r\n                    <span className=\"font-medium\">\r\n                      Home {market.odds.home} / Away {market.odds.away}\r\n                    </span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            ))}\r\n          </div>\r\n\r\n          {/* Odds Trend Chart (mocked for now) */}\r\n          <div className=\"mt-4\">          \r\n            <div className=\"mt-4\">\r\n  <h4 className=\"text-sm font-semibold mb-1\">Odds Movement (Live)</h4>\r\n  <ResponsiveContainer width=\"100%\" height={200}>\r\n    <LineChart data={oddsMovement}>\r\n      <CartesianGrid strokeDasharray=\"3 3\" />\r\n      <XAxis dataKey=\"time\" />\r\n      <YAxis />\r\n      <Tooltip />\r\n      <Line\r\n        type=\"monotone\"\r\n        dataKey=\"odds\"\r\n        stroke=\"#2563eb\"\r\n        strokeWidth={2}\r\n        dot={{ r: 3 }}\r\n      />\r\n    </LineChart>\r\n  </ResponsiveContainer>\r\n</div>\r\n          </div>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OddsWidget;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}